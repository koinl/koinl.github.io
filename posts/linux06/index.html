<!DOCTYPE html>
<html lang="zh-cmn-Hans" prefix="og: http://ogp.me/ns#" class="han-init">
<head>
  <meta charset="utf-8">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />

  <link rel="icon" href="/favicon.ico">
  
  <title>锦鲤未离 | 第六章  网络基础</title>
  
<link rel="stylesheet" href="/css/style.css">

  
<link rel="stylesheet" href="/lib/fancybox/jquery.fancybox-1.3.4.css">

  <!--在这里倒入jquery 方便处理部分页面的jquery-->
  <script src="https://cdn.staticfile.org/jquery/1.7/jquery.min.js" type="text/javascript" ></script>
<meta name="generator" content="Hexo 6.1.0"></head>

<body>
	<header class="site-header navfixed-false">
  <div class="container">
      <h1><a href="/" title="锦鲤未离"><span class="octicon octicon-mark-github"></span> 锦鲤未离</a></h1>
      <nav class="site-header-nav" role="navigation">
        
              
              <a href="/"  class=" site-header-nav-item hvr-underline-from-center" title="Home">Home</a>
        
              
              <a href="/categories/"  class=" site-header-nav-item hvr-underline-from-center" title="Category">Category</a>
        
              
              <a href="/open-source/"  class=" site-header-nav-item hvr-underline-from-center" title="Open-Source">Open-Source</a>
        
              
              <a href="/message/"  class=" site-header-nav-item hvr-underline-from-center" title="Message">Message</a>
        
      </nav>
  </div>
</header>

	
<section class="collection-head geopattern" data-pattern-id="第六章  网络基础" >
    <div class="container">
        <div class="collection-title">
            <h1 class="collection-header">
                第六章  网络基础
            </h1>
            
                <div class="collection-info">
                    <span class="meta-info">
                        <span class="octicon octicon-calendar"></span>
                        <time datetime="2022-06-02T02:17:29.587Z" itemprop="datePublished">2022-06-02</time>
                    </span>
                    
                        <span class="meta-info">
                            <span class="octicon octicon-file-directory"></span>
                            <a href='/categories/Linux/' title=''>Linux</a>
                        </span>
                    
                </div>
            
        </div>
    </div>
</section>
	<section class="container">
    <div class="columns">
        <div class="column  three-fourths " >
            <article class="article-content markdown-body">
                <p>&lt;注: 网卡设备均以设备 ens33 举例子&gt;<br>关于 Linux 的网络配置, 可分为配置网络 IP 临时 [ifconfig, ip] 与 永久 [nmcli, 网络链接配置文件]。<br>临时本篇暂且不论，只论永久。<br>网络配置文件仅作为了解性内容，重点在于 nmcli 的处理。</p>
<p>网络配置文件: vim &#x2F;etc&#x2F;sysconfig&#x2F;network-scripts&#x2F;ifcfg-网卡设备名（ens33等）</p>
<p>网卡设备本身</p>
<p>网卡的连接配置<br>nmcli 分为对设备和连接的设置，多个连接可以应用到同一个设备上面，但同一时间只能启用一个连接</p>
<h2 id="对设备的设置"><a href="#对设备的设置" class="headerlink" title="对设备的设置"></a>对设备的设置</h2><h3 id="查询设备状况"><a href="#查询设备状况" class="headerlink" title="查询设备状况"></a>查询设备状况</h3><p>当查询设备简略时，使用 <code>nmcli device status</code> 就足矣。<br>若要查询所有设备的具体信息，使用 <code>nmcli device show</code>。当然，若在其后加上具体名称，则仅仅查询该设备的信息<br>另外，你还可以将设备进行断连或连接状态。</p>
<h2 id="对连接的设置"><a href="#对连接的设置" class="headerlink" title="对连接的设置"></a>对连接的设置</h2><h3 id="查询连接情况"><a href="#查询连接情况" class="headerlink" title="查询连接情况"></a>查询连接情况</h3><p>简要查询全部信息，使用 <code>nmcli conncetion show</code>，查询某一详细信息，在其后追加其名称。当然，也可以禁用或启用它。</p>
<table>
<thead>
<tr>
<th align="center">用法</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="center">nmcli device status</td>
<td align="center">设备状况</td>
</tr>
<tr>
<td align="center">nmcli device show ens33</td>
<td align="center">显示 ens33 状态</td>
</tr>
<tr>
<td align="center">nmcli d disconnect &#x2F; connect ens33</td>
<td align="center">ens33 设备禁 &#x2F; 启用</td>
</tr>
<tr>
<td align="center">nmcli connection show</td>
<td align="center">显示连接</td>
</tr>
<tr>
<td align="center">nmcli connection show ens33</td>
<td align="center">显示 ens33 网络连接</td>
</tr>
<tr>
<td align="center">nmcli connection down &#x2F; up ens33</td>
<td align="center">禁 &#x2F; 启用连接配置</td>
</tr>
</tbody></table>
<h3 id="对连接配置的修改"><a href="#对连接配置的修改" class="headerlink" title="对连接配置的修改"></a>对连接配置的修改</h3><p>对于修改，无非就是增删改，下面通过例子来说明：</p>
<p>例1：- 创建名为 conn2 的连接配置, 指定静态 ip 地址, 不自动连接. (分配，类型，地址，网关)<br><code>nmcli c a ifname ens33 con-name conn2</code><br><code>ipv4.method manual type Ethernet ipv4.addresses 192.168.85.136/24 gw4 192.168.85.2</code><br><code>autoconnect no</code> </p>
<ul>
<li>经查看, 可知 conn2 连接已存在, 但未关联到某个设备上.<br><code>nmcli c s</code></li>
</ul>
<p>例2：等，见表格下</p>
<table>
<thead>
<tr>
<th align="center">nucli 参数</th>
<th align="center">配置文件参数</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="center">ipv4.method manval &#x2F; auto</td>
<td align="center">BOOTPROTO&#x3D;none or static &#x2F; dhcp</td>
<td align="center">动态分配 IP</td>
</tr>
<tr>
<td align="center">ifname ens33</td>
<td align="center">DEVICE&#x3D;ens33</td>
<td align="center">指定网卡名称</td>
</tr>
<tr>
<td align="center">ipv4.addresses 192.168.100.100&#x2F;24</td>
<td align="center">IPADDR&#x3D;192.168.100.100’&#x2F;n’PREFIX&#x3D;24</td>
<td align="center">IP 地址与掩码位数</td>
</tr>
<tr>
<td align="center">gw4 192.168.100.1(2?)</td>
<td align="center">GATEWAY&#x3D;192.168.100.1</td>
<td align="center">设置网关</td>
</tr>
<tr>
<td align="center">ipv4.dns 8.8.8.8</td>
<td align="center">DNS0&#x3D;8.8.8.8</td>
<td align="center">设置 DNS 服务器</td>
</tr>
<tr>
<td align="center">ipv4.dns-search example.com</td>
<td align="center">DOMAIN&#x3D;example.com</td>
<td align="center">域名</td>
</tr>
<tr>
<td align="center">connection.autoconnect yes</td>
<td align="center">ONBOOT&#x3D;yes</td>
<td align="center">开机自动连接</td>
</tr>
</tbody></table>
<ul>
<li><p>查看 配置文件 conn2<br>cat &#x2F;etc&#x2F;sysconfig&#x2F;network-scripts&#x2F;ifcfg-conn2</p>
</li>
<li><p>首先禁用 ens33 连接, 再启用 conn2 连接. 这就是 两个网络情况下切换网络的方法.<br>nmcli c d ens33<br>nmcli c u conn2</p>
</li>
<li><p>可通过查看连接状态了解详情.<br>nmcli c s</p>
</li>
<li><p>查看 ens33 设备的状态.<br>nmcli d s<br>nmcli d show ens33</p>
</li>
<li><p>修改 conn2 的连接配置, IP为 , DNS 为 , 并设置开机自动启用连接.<br>nmcli c m conn2 ipv4.addresses 192.168.85.59&#x2F;24 ipv4.dns 192.168.85.1 connection.autoconnect yes </p>
</li>
<li><p>查看 ifcfg-conn2配置文件的内容<br>cat -n &#x2F;etc&#x2F;sysconfig&#x2F;network-scripts&#x2F;ifcfg-conn2</p>
</li>
<li><p>重启网络服务, 使新配置生效.<br>systemctl restart network</p>
</li>
<li><p>将网络恢复原先状态<br>nmcli c d conn2</p>
</li>
</ul>
<p>配置文件的修改实际上就是修改连接配置</p>
<details ><summary>点击显/隐查看网卡设备 ens33 的配置文件参数</summary><div class="fold-content"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">TYPE=Ethernet    # 类型</span><br><span class="line">PROXY_METHOD=none</span><br><span class="line">BROWSER_ONLY=no</span><br><span class="line">BOOTPROTO=dhcp    # 静态 none 或 static, 动态 dhcp</span><br><span class="line">DEFROUTE=yes</span><br><span class="line">IPV4_FAILURE_FATAL=no</span><br><span class="line">IPV6INIT=yes</span><br><span class="line">IPV6_AUTOCONF=yes</span><br><span class="line">IPV6_DEFROUTE=yes</span><br><span class="line">IPV6_FAILURE_FATAL=no</span><br><span class="line">IPV6_ADDR_GEN_MODE=stable-privacy</span><br><span class="line">NAME=ens33</span><br><span class="line">UUID=6bf39c75-5e3b-4499-af27-7db5c701ea5e</span><br><span class="line">DEVICE=ens33</span><br><span class="line">ONBOOT=no    # 开机自启</span><br><span class="line">IPADDR=192.168.85.121    # IP</span><br><span class="line">PREFIX=24    # 子网掩码, 24 代表 255.255.255.0</span><br><span class="line">DNS1=192.168.85.2    # DNS</span><br><span class="line">IPADDR1=192.168.85.155    # 第二个 IP</span><br><span class="line">NETMASK1=255.255.255.0 # 子网掩码</span><br></pre></td></tr></table></figure></div></details>

<h2 id="systemctl-命令"><a href="#systemctl-命令" class="headerlink" title="systemctl 命令"></a>systemctl 命令</h2><p>systemctl start 服务名<br>stop,status,restart,enable,disable</p>
<h2 id="主机名"><a href="#主机名" class="headerlink" title="主机名"></a>主机名</h2><p>hostname<br>hostname new_name</p>
<h2 id="ping"><a href="#ping" class="headerlink" title="ping"></a>ping</h2><p>ping -c 3 <a target="_blank" rel="noopener" href="http://www.baidu.com/">www.baidu.com</a><br>检测 IP 连通性</p>
<h2 id="traceroute"><a href="#traceroute" class="headerlink" title="traceroute"></a>traceroute</h2><p>traceroute -q 4 <a target="_blank" rel="noopener" href="http://www.38.com/">www.38.com</a></p>
<h2 id="ip"><a href="#ip" class="headerlink" title="ip"></a>ip</h2><p>ip a show ens33</p>

            </article>
            
                <div class="share">
                    <!--开启分享-->
<div class="share-component" data-disabled="google,twitter,facebook" data-description=""></div>


<script src="/js/share.min.js"></script>


                </div>    
            

            
            
                
<div class="comments">
    <div id="gitalk-container"></div>
        
<script src="/js/gitalk.js"></script>

        <script>
            var gitalk = new Gitalk({
                clientID: "",
                clientSecret: "",
                repo: '',
                owner: '',
                admin: [''],
                id: decodeURI('/posts/linux06/'),
            })
        gitalk.render('gitalk-container')
        </script>
</div>

            

        </div>
        <div class="column one-fourth">
            
                
                


<h3>Post Directory</h3>

<div id="post-directory-module">
	<section class="post-directory">
		<p><strong class="toc-title">文章目录</strong></p>
		<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%B9%E8%AE%BE%E5%A4%87%E7%9A%84%E8%AE%BE%E7%BD%AE"><span class="toc-text">对设备的设置</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E8%AE%BE%E5%A4%87%E7%8A%B6%E5%86%B5"><span class="toc-text">查询设备状况</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%B9%E8%BF%9E%E6%8E%A5%E7%9A%84%E8%AE%BE%E7%BD%AE"><span class="toc-text">对连接的设置</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E8%BF%9E%E6%8E%A5%E6%83%85%E5%86%B5"><span class="toc-text">查询连接情况</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%B9%E8%BF%9E%E6%8E%A5%E9%85%8D%E7%BD%AE%E7%9A%84%E4%BF%AE%E6%94%B9"><span class="toc-text">对连接配置的修改</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#systemctl-%E5%91%BD%E4%BB%A4"><span class="toc-text">systemctl 命令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%BB%E6%9C%BA%E5%90%8D"><span class="toc-text">主机名</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ping"><span class="toc-text">ping</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#traceroute"><span class="toc-text">traceroute</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ip"><span class="toc-text">ip</span></a></li></ol>
	</section>
</div>
            
        </div>
    </div>
</section>

<footer class="container">
    <div class="site-footer" role="contentinfo">
        <div class="copyright left mobile-block">
                © 2016
                <span title="yumemor">yumemor</span>
                <a href="javascript:window.scrollTo(0,0)" class="right mobile-visible">TOP</a>
        </div>

        <ul class="site-footer-links right mobile-hidden">
            <li>
                <a href="javascript:window.scrollTo(0,0)" >TOP</a>
            </li>
        </ul>

        <a href="https://github.com/yumemor/hexo-theme-primer" target="_blank" aria-label="view source code">
            <span class="mega-octicon octicon-mark-github" title="GitHub"></span>
        </a>

        <ul class="site-footer-links mobile-hidden">
            
                  
                  <li>
                    <a href="/"  title="Home">Home</a>
                  </li>
            
                  
                  <li>
                    <a href="/categories/"  title="Category">Category</a>
                  </li>
            
                  
                  <li>
                    <a href="/open-source/"  title="Open-Source">Open-Source</a>
                  </li>
            
                  
                  <li>
                    <a href="/message/"  title="Message">Message</a>
                  </li>
            
            <li>
                <a href="/atom.xml">
                    <span class="octicon octicon-rss" style="color:orange;"></span>
                </a>
            </li>
        </ul>
    </div>
</footer>

		
<script src="/js/geopattern.js"></script>

		
<script src="/js/highlight.pack.js"></script>

		
<script src="/lib/fancybox/jquery.fancybox-1.3.4.pack.js"></script>


		
			
<script src="/js/toc.js"></script>

		

		
<script src="/js/index.js"></script>


		 
<script src="/js/popular_repo.js"></script>
 

	</body>
</html>