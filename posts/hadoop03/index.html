<!DOCTYPE html>
<html lang="zh-CN">
<!-- 
    你好~ 欢迎来到我的乐园。下面就简单介绍下我的 body 部分。
    body 标签，主要是由加载 loading 与应用 app 所组成。
        - loading 加载页面。顾名思义，这里不做详细叙述。
        - app 中，分为头部部分 header、封面部分 cover、主体部分 main 和尾部部分 footer。
            - header、cover、footer 你可以分别在页面最上方，页面的中上方、页面的最下方找到。
                > 文章页找不到 cover、主页找不到 header 与 cover...还有什么页找不到什么？
            - main 中，有初始/列表页、文章页、主页、搜索页、友链页，错误页。
                - 初始/列表页在进入网站后即可看见。
                - 文章页需要点击文章后进入。
                - 让你有搜索内容需求时，可以进入搜索页。
                - 与其他人的交互，则尽在友链页。
                - 另外，我还新创建了主页，欢迎观看。
                - 最后，当你进入了不存在的页面时，就会出现错误页。
    祝你阅读愉快！ 
-->
<head>
    <title>第三章  MapReduce基础 | 锦鲤未离</title>
    <meta name="keywords" content="Hadoop">
    <meta charset="utf-8">
    <meta name="renderer" content="webkit">
    <meta name="copyright" content="Koi_NL">
    <meta name="generator" content="Hexo 6.1.0">
    <meta name="HandheldFriendly" content="True">
    <meta name="force-rendering" content="webkit">
    <meta name="author" content="Koi_NL,1099771017@qq.com"> 
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="mask-icon" href="/img/icon.png">
    <link rel="shortcut icon" href="/img/icon.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/img/icon.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/img/icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/img/icon.png">
    <link rel="canonical" href="http://example.com/posts/hadoop03/">
    <link rel="stylesheet" href="/css/main.css">
    <link rel="stylesheet" href="/css/dark.css">
    <link rel="stylesheet" id="hl-default-theme" href="/css/hlight-main.css" media="none">
    <link rel="stylesheet" id="hl-dark-theme" href="/css/hlight-dark.css" media="none">
    
    <script type="text/javascript" src="https://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
</head>

<body>
    <div class="loading"><span></span><span></span><span></span><span></span><span></span></div>
    <script>document.onreadystatechange=function(){console.log(document.readyState);if(document.readyState=="complete"){$(".loading").fadeOut();}}</script>

    <div id="app">
<header class="header">
    <div class="header__left"><a href="/" class="button" title="回到首页">
            <svg t="1662257077921" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
                p-id="9718" width="27" height="27">
                <path
        d="M1017.295381 515.625294c-8.918711 9.05797-23.377057 9.05797-32.295768 0L755.083237 303.3395c-1.513416-1.206227-2.807704-2.525091-3.989357-4.056938l-89.551638-90.944226c-1.513416-1.200084-2.807704-2.512803-3.989357-4.050794L512.000756 56.462215 38.999851 515.625294c-8.918711 9.05797-23.377057 9.05797-32.29372 0-8.918711-9.05797-8.918711-23.73954 0-32.797509L493.065647 10.095158c0.77002-1.130454 1.234898-2.394024 2.224046-3.405698 4.603734-4.677459 10.67583-6.829828 16.711063-6.682377 6.033185-0.147451 12.105281 2.004918 16.709015 6.682377 0.989147 1.011675 1.454026 2.275244 2.224046 3.405698l121.376383 123.262521L652.3102 71.16836c0 0-0.002048 0-0.002048-0.006144 0-13.114908 10.471037-23.751827 23.385249-23.751827l93.538947 0c6.459154 0 12.305978 2.660254 16.536989 6.952703 4.23306 4.298593 6.850307 10.24167 6.850307 16.799124l0 204.700282 224.675737 206.965287C1026.212043 491.885755 1026.212043 506.567325 1017.295381 515.625294zM745.851194 94.907899l-46.770497 0 0 85.959578 46.770497 47.491367L745.851194 94.907899zM163.72459 474.910509c12.916259 0 23.385249 10.630776 23.385249 23.745683l0 430.348784c0 26.235959 20.940027 47.49751 46.770497 47.49751l161.196225 0-0.002048 0L395.074513 688.656474c0-13.121052 10.471037-23.751827 23.385249-23.751827l187.079941 0c12.916259 0 23.385249 10.630776 23.385249 23.751827l0 287.846013-0.002048 0 161.196225 0c25.83047 0 46.768449-21.261551 46.768449-47.49751l-0.002048-430.348784c0-13.114908 10.468989-23.745683 23.385249-23.745683 12.914211 0 23.385249 10.630776 23.385249 23.745683l0 430.348784c0 52.469871-41.878006 94.995021-93.538947 94.995021L233.880336 1023.999997c-51.660941 0-93.538947-42.52515-93.538947-94.995021L140.34139 498.656193C140.34139 485.541285 150.810379 474.910509 163.72459 474.910509zM582.154454 976.502487l0-264.100329-140.309444 0 0 264.100329-0.002048 0L582.154454 976.502487 582.154454 976.502487z"
        p-id="44080" fill="#999"></path>
            </svg>
        </a></div>
    <div class="header__right">
        <style>
            /* From uiverse.io by @satyamchaudharydev */
    /* From uiverse.io by @satyamchaudharydev */
    /* removing default style of button */
    
    .Header_search_form button {
      border: none;
      background: none;
      color: #8b8ba7;
    }
    /* styling of whole input container */
    .Header_search_form {
      --timing: 0.3s;
      --width-of-input: 200px;
      --height-of-input: 40px;
      --border-height: 2px;
      --input-bg: #fff;
      --border-color: #2f2ee9;
      --border-radius: 30px;
      --after-border-radius: 1px;
      position: relative;
      width: var(--width-of-input);
      height: var(--height-of-input);
      display: flex;
      align-items: center;
      padding-inline: 0.8em;
      border-radius: var(--border-radius);
      transition: border-radius 0.5s ease;
      background: var(--input-bg,#fff);
    }
    /* styling of Input */
    .search___input {
      font-size: 0.9rem;
      background-color: transparent;
      width: 100%;
      height: 100%;
      padding-inline: 0.5em;
      padding-block: 0.7em;
      border: none;
    }
    /* styling of animated border */
    .Header_search_form:before {
      content: "";
      position: absolute;
      background: var(--border-color);
      transform: scaleX(0);
      transform-origin: center;
      width: 100%;
      height: var(--border-height);
      left: 0;
      bottom: 0;
      border-radius: 1px;
      transition: transform var(--timing) ease;
    }
    /* Hover on Input */
    .Header_search_form:focus-within {
      border-radius: var(--after-border-radius);
    }
    
    .search___input:focus {
      outline: none;
    }
    /* here is code of animated border */
    .Header_search_form:focus-within:before {
      transform: scale(1);
    }
    /* styling of close button */
    /* == you can click the close button to remove text == */
    .search_reset {
      border: none;
      background: none;
      opacity: 0;
      visibility: hidden;
    }
    /* close button shown when typing */
    .search___input:not(:placeholder-shown) ~ .search_reset {
      opacity: 1;
      visibility: visible;
    }
    /* sizing svg icons */
    .Header_search_form svg {
      width: 17px;
      margin-top: 3px;
    }
        </style>
      <form class="Header_search_form">
        <button>
            <svg width="17" height="16" fill="none" xmlns="http://www.w3.org/2000/svg" role="img" aria-labelledby="search">
                <path d="M7.667 12.667A5.333 5.333 0 107.667 2a5.333 5.333 0 000 10.667zM14.334 14l-2.9-2.9" stroke="currentColor" stroke-width="1.333" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
        </button>
        <input class="search___input" placeholder="Type your text" required="" type="text" onClick='Go_Page_search()' value="0">
        <button class="search_reset" type="reset">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"></path>
            </svg>
        </button>
    </form>
    <script language=javascript> function Go_Page_search() { 
        var Custom_path = 'https://koinl.github.io/'; 
        if (document.Header_search_form.search___input.value == 1) 
        { window.location.href = Custom_path; } 
        else { window.location.href = Custom_path + 'page/' + document.formpage.SkipPage.value + '/'; } }
    </script>
        <a href="javaScript:void(0);" id="btn-toggle-dark" title="夜间模式">
            <svg t="1662256981531" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
                p-id="8697" width="30" height="30">
                <path d="M89.85 197.55m-26.03 0a26.03 26.03 0 1 0 52.06 0 26.03 26.03 0 1 0-52.06 0Z" fill="#999"
                    opacity=".8" p-id="34043"></path>
                <path d="M135.4 99.52m-26.03 0a26.03 26.03 0 1 0 52.06 0 26.03 26.03 0 1 0-52.06 0Z" fill="#999"
                    opacity=".8" p-id="34044"></path>
                <path d="M934.15 145.07m-26.03 0a26.03 26.03 0 1 0 52.06 0 26.03 26.03 0 1 0-52.06 0Z" fill="#999"
                    opacity=".8" p-id="34045"></path>
                <path d="M612.93 189.8V194.82h0.51c2.42 15.26 15.54 26.96 31.48 26.96h196.21c15.94 0 29.05-11.7 31.48-26.96h0.5v-15.45c0-17.67-14.31-31.98-31.98-31.98H644.91c-17.66 0-31.99 14.32-31.99 31.98v10.43zM619.43 411.04V416.06h0.51c2.42 15.26 15.54 26.96 31.48 26.96h196.21c15.94 0 29.05-11.7 31.48-26.96h0.5v-15.45c0-17.67-14.31-31.98-31.98-31.98H651.42c-17.66 0-31.99 14.32-31.99 31.98v10.43z"
                    fill="#999" opacity=".8" p-id="34046"></path>
                <path d="M632.26 430.79c0.01 0 0.01 0.01 0.03 0.02l3.25 3.78 0.39-0.33c11.79 10 29.36 10.31 41.45-0.09l178.53-217.51c12.09-10.39 14.4-27.81 6.28-40.97l0.38-0.32-3.27-3.81-5.83-6.77-0.97-1.13c-11.52-13.4-31.7-14.91-45.1-3.39L628.86 377.78c-13.39 11.51-14.91 31.72-3.39 45.11l0.97 1.13 5.82 6.77z"
                    fill="#999" opacity=".8" p-id="34047"></path>
                <path d="M511.94 950.5c-233.06 0-422.66-189.65-422.66-422.75 0-190.41 128.42-358.05 312.31-407.65 13.22-3.52 27.25 1.33 35.41 12.34 8.14 11.01 8.71 25.88 1.42 37.47-31.43 50.03-48.04 107.45-48.04 166.05 0 172.59 140.48 313.02 313.17 313.02 58.73 0 116.22-16.67 166.28-48.23a33.279 33.279 0 0 1 37.49 1.37 33.281 33.281 0 0 1 12.37 35.4C870.16 821.8 702.49 950.5 511.94 950.5zM344.17 213.93C230.3 274.77 155.8 394.66 155.8 527.76c0 196.42 159.76 356.22 356.13 356.22 133.25 0 253.21-74.72 314-188.92a376.765 376.765 0 0 1-122.39 20.44c-209.36 0-379.7-170.26-379.7-379.53 0.01-41.53 6.87-82.76 20.33-122.04z m0 0"
                    fill="#999" opacity=".8" p-id="34048"></path>
            </svg>
        </a>
    </div>
    <script>(() => { const rootElement = document.documentElement; const darkModeStorageKey = 'user-color-scheme'; const darkModeMediaQueryKey = '--color-mode'; const rootElementDarkModeAttributeName = 'data-user-color-scheme'; const setLS = (k, v) => { try { localStorage.setItem(k, v); } catch (e) { } }; const removeLS = (k) => { try { localStorage.removeItem(k); } catch (e) { } }; const getLS = (k) => { try { return localStorage.getItem(k); } catch (e) { return null; } }; const getModeFromCSSMediaQuery = () => { const res = getComputedStyle(rootElement).getPropertyValue(darkModeMediaQueryKey); if (res.length) return res.replace(/["'\s]/g, ''); return res === 'dark' ? 'dark' : 'light'; }; const resetRootDarkModeAttributeAndLS = () => { rootElement.removeAttribute(rootElementDarkModeAttributeName); removeLS(darkModeStorageKey); }; const validColorModeKeys = { dark: true, light: true, }; const applyCustomDarkModeSettings = (mode) => { const currentSetting = mode || getLS(darkModeStorageKey); if (document.getElementById('hl-dark-theme')) { if (validColorModeKeys[currentSetting]) { if (currentSetting === 'dark') { document.getElementById('hl-default-theme').media = 'none'; document.getElementById('hl-dark-theme').media = 'all'; } else { document.getElementById('hl-dark-theme').media = 'none'; document.getElementById('hl-default-theme').media = 'all'; } } else { if (getModeFromCSSMediaQuery() === 'dark') { document.getElementById('hl-default-theme').media = 'none'; document.getElementById('hl-dark-theme').media = 'all'; } else { document.getElementById('hl-dark-theme').media = 'none'; document.getElementById('hl-default-theme').media = 'all'; } } } else if (document.getElementById('hl-default-theme')) { document.getElementById('hl-default-theme').media = 'all'; } if (currentSetting === getModeFromCSSMediaQuery()) { resetRootDarkModeAttributeAndLS(); } else if (validColorModeKeys[currentSetting]) { rootElement.setAttribute(rootElementDarkModeAttributeName, currentSetting); } else { resetRootDarkModeAttributeAndLS(); } }; const invertDarkModeObj = { dark: 'light', light: 'dark', }; const toggleCustomDarkMode = () => { var currentSetting = getLS(darkModeStorageKey); if (validColorModeKeys[currentSetting]) { currentSetting = invertDarkModeObj[currentSetting]; } else if (currentSetting === null) { currentSetting = invertDarkModeObj[getModeFromCSSMediaQuery()]; } else { return; } setLS(darkModeStorageKey, currentSetting); return currentSetting; }; applyCustomDarkModeSettings(); window.onload = () => { const darkModeToggleBottonElement = document.getElementById('btn-toggle-dark'); darkModeToggleBottonElement.addEventListener('click', () => { applyCustomDarkModeSettings(toggleCustomDarkMode()); }); }; })();</script>
</header>


        <div class="cover">
            <div class="cover__logo">
                <div class="carousel" id="carousel_main">
                    <ul id="div_img">
                        <li class="every_img"><img src="/img/cover/LunBoTu/home_welcome.jpg" id="link_img" onClick="link('https://koinl.github.io/page_home/', '_self')" alt="" title="" /></li>
                        <li class="every_img"><img src="/img/cover/LunBoTu/Picture_APP_By_KoiNL.jpg" id="link_img" onClick="link('https://koinl.github.io/apk/APP_By_KoiNL.apk', '_self')" alt="" title="" /></li>
                        <li class="every_img"><img src="/img/cover/LunBoTu/new_blog_theme.jpg" id="link_img" onClick="link('https://koinl.github.io/', '_self')" alt="" title="" /></li>
                        <li class="every_img"><img src="/img/test/test4.jpg" id="link_img" onClick="link('https://www.qidian.com/', '_self')" alt="" title="" /></li>
                        <li class="every_img"><img src="/img/test/test5.jpg" id="link_img" onClick="link('https://www.csdn.net/', '_self')" alt="" title="" /></li>
                    </ul>
                    <ul class="div_circle"><li class = every_circle></li><li class = every_circle></li><li class = every_circle></li><li class = every_circle></li><li class = every_circle></li></ul>
                    <div class="btn left"><p class="btn_p">《&nbsp</p></div><div class="btn right"><p class="btn_p">&nbsp》</p></div>
                </div><script type="text/javascript"> $(function (){ var max_num=4; var time_stop=4250; var time_swap=1250; var num =0; var chosen_circle_color="#0aa1ed"; var chosen_not_circle_color="#ffffff"; function every_thing(){$("#div_img").animate({left:-$(".every_img").eq(0).width()*num},time_swap); $(".every_circle").eq(num).css("background",chosen_circle_color) .siblings('li').css("background",chosen_not_circle_color);} function Right_move(){if(num>=max_num){num=0;}else{num++;}every_thing();} function Left_move(){if(num===0){num=max_num;}else{num--;}every_thing();} $(".every_circle").eq(0).css("background",chosen_circle_color); $("#div_img").width($('.every_img').length*$('.every_img').eq(0).width()); var id =setInterval(Right_move,time_stop); $("#carousel_main").mouseover(function (){clearInterval(id)}); $("#carousel_main").mouseout(function (){id=setInterval(Right_move,time_stop);}); $(".left").click(function (){ $("#div_img").stop(); Left_move(); }); $(".right").click(function (){ $("#div_img").stop(); Right_move(); }); $(".every_circle").mouseover(function (){num =$(this).index(); $("#div_img").stop(); every_thing();}); }); function link(jinliweili_Url, quality_target){window.open(jinliweili_Url,quality_target);}</script>
            </div>
            <div class="cover__desc">
                <div class='avator_logo_link'><img alt="離.png" src="/img/avator.png"></div>
                <div class="desc-com"><div class="desc-button"><div class="desc-box">是</div><div class="desc-box">锦</div><div class="desc-box">鲤</div><div class="desc-box">未</div><div class="desc-box">离</div></div></div>
                <button class="btn-cssbuttons">
                    <span class="btn-cssbuttons-span">
                        <svg t="1662258197467" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="31880" width="18" height="18"><path d="M512 164.7c12.9 0 25.9 0.7 39.1 2.1 163.3 17.9 294.5 153.8 307 317.6 5.4 71.2-10.4 138-42.2 195.2-15.8 28.4-13.8 63.3 2.4 91.4l27.5 47.5c10.4 18-2.6 40.4-23.3 40.4h-286l0.7-1c-8.4 0.7-16.8 1-25.1 1-23.3 0-46.5-2.6-69.8-7.6C300.1 820.5 187.4 704 168 559.9c-28.5-213 136.5-395.1 344-395.2m0-100.5c-129.1 0-251.9 55.8-337 153-85 97.2-123.8 226.9-106.5 356 24.8 184.7 166.4 336 352.4 376.4 30.3 6.6 61 9.9 91.2 9.9 5.5 0 11-0.1 16.4-0.3 2.7 0.2 5.3 0.3 8 0.3h286c45.4 0 87.7-24.4 110.4-63.8 22.7-39.3 22.7-88.2-0.1-127.5L906.7 723c40.4-75 58.2-160 51.6-246.3C942.3 266.1 771.9 89.9 562 67c-16.6-1.9-33.4-2.8-50-2.8z" p-id="31881" fill="#999"></path><path d="M331.4 511.9m-50.3 0a50.3 50.3 0 1 0 100.6 0 50.3 50.3 0 1 0-100.6 0Z" p-id="31882" fill="#999"></path><path d="M512 511.9m-50.3 0a50.3 50.3 0 1 0 100.6 0 50.3 50.3 0 1 0-100.6 0Z" p-id="31883" fill="#999"></path><path d="M692.6 511.9m-50.3 0a50.3 50.3 0 1 0 100.6 0 50.3 50.3 0 1 0-100.6 0Z" p-id="31884" fill="#999"></path></svg>
                    </span>
                    <span>　　　　</span>
                    <ul>
                        <li id="WeChat"><a href="/img/cover/btn-cssbuttons-span/WeChat.jpg" title="WeChat" target="_blank"><svg height="18" width="18" xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 1024 1024" class="icon"> <path d="M676.325 381.17h5.098c-25.972-114.081-144.421-200.37-286.538-200.37-161.17 0-291.877 110.804-291.877 247.581 0 79.493 44.176 150.247 112.867 195.516l-28.884 85.925 101.702-50.486-1.942-0.971c33.497 11.286 69.905 17.598 108.134 17.598 8.617 0 17.234-0.364 25.729-0.971-7.646-21.117-11.893-43.691-11.893-66.992 0-125.125 119.786-226.828 267.605-226.828zM489.184 319.276c21.482 0 38.836 15.292 38.836 34.102 0 14.563-10.437 27.065-25.122 31.918-4.247 1.456-8.86 2.185-13.714 2.185-21.482 0-38.836-15.292-38.836-34.102s17.476-34.102 38.836-34.102zM315.634 385.419c-4.247 1.456-8.86 2.185-13.714 2.185-21.482 0-38.836-15.292-38.836-34.102s17.355-34.102 38.836-34.102 38.836 15.292 38.836 34.102c0 14.563-10.437 27.065-25.122 31.918z" fill="#999999" p-id="3256"></path> <path d="M922.45 608.241c0-115.295-110.197-208.865-246.124-208.865s-246.124 93.45-246.124 208.865 110.197 208.865 246.124 208.865c30.462 0 59.711-4.733 86.774-13.349l78.279 42.962-21.117-69.177c61.895-37.866 102.188-99.638 102.188-169.301zM610.546 570.254c-3.519 1.214-7.404 1.821-11.408 1.821-17.962 0-32.526-12.865-32.526-28.641s14.563-28.641 32.526-28.641 32.526 12.865 32.526 28.641c0 12.257-8.738 22.695-21.117 26.821zM769.897 570.254c-3.519 1.214-7.404 1.821-11.408 1.821-17.962 0-32.526-12.865-32.526-28.641s14.563-28.641 32.526-28.641 32.526 12.865 32.526 28.641c0 12.257-8.738 22.695-21.117 26.821z" fill="#999999" p-id="3257"></path> </svg></a></li>
                        <li id="Telegram"><a href="/img/cover/btn-cssbuttons-span/Telegram.jpg" title="Telegram" target="_blank"><svg height="18" width="18" xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 1024 1024" class="icon"> <path d="M417.28 795.733333l11.946667-180.48 327.68-295.253333c14.506667-13.226667-2.986667-19.626667-22.186667-8.106667L330.24 567.466667 155.306667 512c-37.546667-10.666667-37.973333-36.693333 8.533333-55.466667l681.386667-262.826666c31.146667-14.08 61.013333 7.68 49.066666 55.466666l-116.053333 546.56c-8.106667 38.826667-31.573333 48.213333-64 30.293334L537.6 695.466667l-84.906667 82.346666c-9.813333 9.813333-17.92 17.92-35.413333 17.92z" fill="#999999"></path></svg></a></li>
                        <li id="E-mail"><a href="/img/cover/btn-cssbuttons-span/G-mail.jpg" title="G-mail" target="_blank"><svg height="18" width="18" xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 1024 1024" class="icon"> <path d="M134 297.4c22 11.6 327.6 178.2 339 184.2 11.4 6 23 8.8 41 8.8 18 0 29.6-2.8 41-8.8 11.4-6 317-172.6 339-184.2 8.2-4.2 22-11.8 25-20.4 5.2-15.2-0.4-21-22.6-21L514 256 131.6 256c-22.2 0-27.8 6-22.6 21C112 285.8 125.8 293.2 134 297.4z" p-id="5247" fill="#999"></path> <path d="M911.4 306.4c-16.4 8.4-163.6 113.2-261 176.2l164.4 185c4 4 5.8 8.8 3.6 11.2-2.4 2.2-7.6 1-11.8-2.8l-197.2-166.4c-29.8 19.2-50.8 32.4-54.4 34.4-15.4 7.8-26.2 8.8-41 8.8-14.8 0-25.6-1-41-8.8-3.8-2-24.6-15.2-54.4-34.4l-197.2 166.4c-4 4-9.4 5.2-11.8 2.8-2.4-2.2-0.6-7.2 3.4-11.2l164.2-185c-97.4-63-246.2-167.8-262.6-176.2-17.6-9-18.6 1.6-18.6 9.8 0 8.2 0 410 0 410 0 18.6 27.4 41.8 47 41.8L514 768l371 0c19.6 0 43-23.4 43-41.8 0 0 0-402 0-410C928 307.8 929.2 297.4 911.4 306.4z" p-id="5248" fill="#999"></path></svg></a></li>
                        <li id="Github">
                            <a href="https://github.com/koinl" title="Github" target="_blank">
                                <svg height="13" width="18" xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 1024 1024" class="icon">
                                    <path d="M855.557 216.855c35.621-66.153-5.089-152.661-5.089-152.661-91.597 0-157.75 61.064-157.75 61.064-35.621-20.355-152.661-20.355-152.661-20.355s-117.04 0-152.661 20.355c0 0-66.153-61.064-157.75-61.064 0 0-40.71 86.508-5.089 152.661 0 0-81.419 76.331-50.887 239.169 28.691 153.018 162.838 193.371 249.346 193.371 0 0-35.621 30.532-30.532 81.419 0 0-50.887 30.532-101.774 10.177s-76.331-71.242-76.331-71.242-50.887-66.153-101.774-40.71c0 0-15.266 15.266 40.71 40.71 0 0 40.71 61.064 55.976 96.685 15.266 35.621 96.685 66.153 178.105 45.798v117.04s0 10.177-20.355 15.266-20.355 15.266-10.177 15.266H723.25c10.177 0 10.177-10.177-10.177-15.266-20.355-5.089-20.355-15.266-20.355-15.266v-117.04s0.447-61.03 0-81.419c-1.119-51.128-35.621-81.419-35.621-81.419 86.508 0 220.655-40.353 249.346-193.371 30.533-162.837-50.886-239.168-50.886-239.168z" p-id="3872" fill="#999999"></path>
                                </svg>
                            </a>
                        </li>
                    </ul>
                </button>
            </div>
            <div class="cover__intro">
                <details>
                    <summary>
                        <a href="/page_home/" target="_self"><button>主页</button></a> 
                        <a href="/" target="_self"><button>首页</button></a> 
                        <a href="/page_search/" target="_self"><button>搜索页</button></a> 
                        <a href="/page_friends/" target="_self"><button>友链页</button></a> 
                        <p title="打开分类">分类流</p>
                    </summary>
                    <div class="fold-content">
                        <div class="dropdown-menus" id="dropdown-menus"> • 分类 • 
                            <a href="/categories/Hadoop/" class="dropdown-menu button">Hadoop</a> • 
                            <a href="/categories/Data-Processing-and-Analysing/" class="dropdown-menu button">数据处理与分析(Py)</a> • 
                            <a href="/categories/Data-Visualization/" class="dropdown-menu button">数据可视化</a> • 
                            <a href="/categories/Data-Mining/" class="dropdown-menu button">数据挖掘</a> • 
                            <a href="/categories/Mathematical-Modeling/" class="dropdown-menu button">数学建模</a> • 
                            <a href="/categories/Python/" class="dropdown-menu button">Python</a> • 
                            <a href="/categories/Linux/" class="dropdown-menu button">Linux</a> • 
                            <a href="/categories/Data-Structure-and-Algorithm/" class="dropdown-menu button">数据结构与算法</a> • 
                            <a href="/categories/SqlServer/" class="dropdown-menu button">SQL Server</a> • 
                            <a href="/categories/MATLAB/" class="dropdown-menu button">MATLAB</a> • 
                            <a href="/categories/java/" class="dropdown-menu button">Java</a> • 
                            <a href="/categories/%E7%94%B5%E5%AD%90%E8%AE%BE%E5%A4%87/" class="dropdown-menu button">电子设备</a> • 
                        </div>
                    </div>
                </details>
            </div>
        </div>
<!-- 我们是__应用部分！我是__文章部分！ -->
        <main class="main POST">
            <!-- 一、上·位置 --><style>.cover {clip-path: circle(0); max-width: 1px; max-height: 1px; min-height: 0; margin: 0; line-height: 0;}</style>
            <div class="post-title">
                <!-- 1. 文章标题 -->
                <h1 class="post-title__text">第三章  MapReduce基础</h1>
                <!-- 2. 时间与类别 -->
                <div class="post-title__meta">
                    <p>创建于  2022-09-07 12:21:59 星期三 · </p>
                    <a href="/categories/Hadoop/" class="button">Hadoop</a>
                </div>
            </div>
            <!-- 二、右·位置 -->
            <aside class="post-side">
                <!-- 1. 文章目录 -->
                <div class="post-side__toc">
                    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81MapReduce-%E6%A6%82%E8%BF%B0"><span class="toc-text">一、MapReduce 概述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%88%86%E5%B8%83%E5%BC%8F%E5%B9%B6%E8%A1%8C%E8%AE%A1%E7%AE%97"><span class="toc-text">1. 分布式并行计算</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%88%86%E5%B8%83%E5%BC%8F%E8%AE%A1%E7%AE%97"><span class="toc-text">1) 分布式计算</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%B9%B6%E8%A1%8C%E8%AE%A1%E7%AE%97"><span class="toc-text">2) 并行计算</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-MapReduce-%E7%9A%84%E5%90%AB%E4%B9%89"><span class="toc-text">2. MapReduce 的含义</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-MapReduce-%E7%9A%84%E7%89%B9%E7%82%B9"><span class="toc-text">3. MapReduce 的特点</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81MapReduce-%E7%9A%84%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B"><span class="toc-text">二、MapReduce 的工作流程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E8%BE%93%E5%85%A5%E5%88%86%E7%89%87%E5%92%8C%E6%95%B0%E6%8D%AE%E6%A0%BC%E5%BC%8F%E5%8C%96"><span class="toc-text">1. 输入分片和数据格式化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-Map-%E8%BF%87%E7%A8%8B"><span class="toc-text">2. Map 过程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-Shuffle-%E8%BF%87%E7%A8%8B"><span class="toc-text">3. Shuffle 过程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-Reduce-%E8%BF%87%E7%A8%8B"><span class="toc-text">4. Reduce 过程</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E6%A1%88%E4%BE%8B%E8%A7%A3%E6%9E%90%E2%80%94%E2%80%94%E5%8D%95%E8%AF%8D%E7%BB%9F%E8%AE%A1%E7%BC%96%E7%A8%8B"><span class="toc-text">三、案例解析——单词统计编程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%A1%88%E4%BE%8B%E6%8F%8F%E8%BF%B0"><span class="toc-text">1. 案例描述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E8%AE%BE%E8%AE%A1%E6%80%9D%E8%B7%AF"><span class="toc-text">2. 设计思路</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E7%BC%96%E7%A8%8B%E5%AE%9E%E7%8E%B0"><span class="toc-text">3. 编程实现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E8%BF%90%E8%A1%8C%E7%A8%8B%E5%BA%8F"><span class="toc-text">4. 运行程序</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E6%A1%88%E4%BE%8B%E8%A7%A3%E6%9E%90%E2%80%94%E2%80%94%E4%BA%8C%E6%AC%A1%E6%8E%92%E5%BA%8F%E7%BC%96%E7%A8%8B"><span class="toc-text">四、案例解析——二次排序编程</span></a></li></ol>
                </div>
            </aside>
            <!-- 2. 小界面目录图标 -->
            <a class="btn-toc button" id="btn-toc" tabindex="0">
                <svg t="1662257293901" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="29423" width="55" height="55">
                    <path d="M480 64C214.848 64 0 278.848 0 544S214.848 1024 480 1024 960 809.152 960 544 745.152 64 480 64zM288 768C270.336 768 256 753.664 256 736S270.336 704 288 704 320 718.336 320 736 305.664 768 288 768zM288 576C270.336 576 256 561.664 256 544S270.336 512 288 512 320 526.336 320 544 305.664 576 288 576zM288 384C270.336 384 256 369.664 256 352S270.336 320 288 320 320 334.336 320 352 305.664 384 288 384zM672 768l-256 0C398.336 768 384 753.664 384 736S398.336 704 416 704l256 0c17.664 0 32 14.336 32 32S689.664 768 672 768zM672 576l-256 0C398.336 576 384 561.664 384 544S398.336 512 416 512l256 0C689.664 512 704 526.336 704 544S689.664 576 672 576zM672 384l-256 0C398.336 384 384 369.664 384 352S398.336 320 416 320l256 0C689.664 320 704 334.336 704 352S689.664 384 672 384z" p-id="43077" fill="#bfbfbf"></path>
            </svg>
            </a>
            <!-- 3. 小界面目录流 -->
            <div class="toc-menus" id="toc-menus">
                <div class="toc-title">
                    文章目录
                </div>
                <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81MapReduce-%E6%A6%82%E8%BF%B0"><span class="toc-text">一、MapReduce 概述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%88%86%E5%B8%83%E5%BC%8F%E5%B9%B6%E8%A1%8C%E8%AE%A1%E7%AE%97"><span class="toc-text">1. 分布式并行计算</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%88%86%E5%B8%83%E5%BC%8F%E8%AE%A1%E7%AE%97"><span class="toc-text">1) 分布式计算</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%B9%B6%E8%A1%8C%E8%AE%A1%E7%AE%97"><span class="toc-text">2) 并行计算</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-MapReduce-%E7%9A%84%E5%90%AB%E4%B9%89"><span class="toc-text">2. MapReduce 的含义</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-MapReduce-%E7%9A%84%E7%89%B9%E7%82%B9"><span class="toc-text">3. MapReduce 的特点</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81MapReduce-%E7%9A%84%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B"><span class="toc-text">二、MapReduce 的工作流程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E8%BE%93%E5%85%A5%E5%88%86%E7%89%87%E5%92%8C%E6%95%B0%E6%8D%AE%E6%A0%BC%E5%BC%8F%E5%8C%96"><span class="toc-text">1. 输入分片和数据格式化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-Map-%E8%BF%87%E7%A8%8B"><span class="toc-text">2. Map 过程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-Shuffle-%E8%BF%87%E7%A8%8B"><span class="toc-text">3. Shuffle 过程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-Reduce-%E8%BF%87%E7%A8%8B"><span class="toc-text">4. Reduce 过程</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E6%A1%88%E4%BE%8B%E8%A7%A3%E6%9E%90%E2%80%94%E2%80%94%E5%8D%95%E8%AF%8D%E7%BB%9F%E8%AE%A1%E7%BC%96%E7%A8%8B"><span class="toc-text">三、案例解析——单词统计编程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%A1%88%E4%BE%8B%E6%8F%8F%E8%BF%B0"><span class="toc-text">1. 案例描述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E8%AE%BE%E8%AE%A1%E6%80%9D%E8%B7%AF"><span class="toc-text">2. 设计思路</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E7%BC%96%E7%A8%8B%E5%AE%9E%E7%8E%B0"><span class="toc-text">3. 编程实现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E8%BF%90%E8%A1%8C%E7%A8%8B%E5%BA%8F"><span class="toc-text">4. 运行程序</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E6%A1%88%E4%BE%8B%E8%A7%A3%E6%9E%90%E2%80%94%E2%80%94%E4%BA%8C%E6%AC%A1%E6%8E%92%E5%BA%8F%E7%BC%96%E7%A8%8B"><span class="toc-text">四、案例解析——二次排序编程</span></a></li></ol>
            </div>
            <!-- 三、中·正文 -->
            <article class="post post__with-toc content-card">
                <!-- 1. 正文缩略图 -->
                <div class="post__header">
                </div>
                <!-- 2. 正文目录 -->
                <div class="wenzhangmulu">文章目录</div>
                <div class="post-side__toc zheng_wen_de_mu_lu_xia_hua_xian">
                    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81MapReduce-%E6%A6%82%E8%BF%B0"><span class="toc-text">一、MapReduce 概述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%88%86%E5%B8%83%E5%BC%8F%E5%B9%B6%E8%A1%8C%E8%AE%A1%E7%AE%97"><span class="toc-text">1. 分布式并行计算</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%88%86%E5%B8%83%E5%BC%8F%E8%AE%A1%E7%AE%97"><span class="toc-text">1) 分布式计算</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%B9%B6%E8%A1%8C%E8%AE%A1%E7%AE%97"><span class="toc-text">2) 并行计算</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-MapReduce-%E7%9A%84%E5%90%AB%E4%B9%89"><span class="toc-text">2. MapReduce 的含义</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-MapReduce-%E7%9A%84%E7%89%B9%E7%82%B9"><span class="toc-text">3. MapReduce 的特点</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81MapReduce-%E7%9A%84%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B"><span class="toc-text">二、MapReduce 的工作流程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E8%BE%93%E5%85%A5%E5%88%86%E7%89%87%E5%92%8C%E6%95%B0%E6%8D%AE%E6%A0%BC%E5%BC%8F%E5%8C%96"><span class="toc-text">1. 输入分片和数据格式化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-Map-%E8%BF%87%E7%A8%8B"><span class="toc-text">2. Map 过程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-Shuffle-%E8%BF%87%E7%A8%8B"><span class="toc-text">3. Shuffle 过程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-Reduce-%E8%BF%87%E7%A8%8B"><span class="toc-text">4. Reduce 过程</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E6%A1%88%E4%BE%8B%E8%A7%A3%E6%9E%90%E2%80%94%E2%80%94%E5%8D%95%E8%AF%8D%E7%BB%9F%E8%AE%A1%E7%BC%96%E7%A8%8B"><span class="toc-text">三、案例解析——单词统计编程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%A1%88%E4%BE%8B%E6%8F%8F%E8%BF%B0"><span class="toc-text">1. 案例描述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E8%AE%BE%E8%AE%A1%E6%80%9D%E8%B7%AF"><span class="toc-text">2. 设计思路</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E7%BC%96%E7%A8%8B%E5%AE%9E%E7%8E%B0"><span class="toc-text">3. 编程实现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E8%BF%90%E8%A1%8C%E7%A8%8B%E5%BA%8F"><span class="toc-text">4. 运行程序</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E6%A1%88%E4%BE%8B%E8%A7%A3%E6%9E%90%E2%80%94%E2%80%94%E4%BA%8C%E6%AC%A1%E6%8E%92%E5%BA%8F%E7%BC%96%E7%A8%8B"><span class="toc-text">四、案例解析——二次排序编程</span></a></li></ol>
                </div>
                <!-- 3. 正文文章 -->
                <div class="post__content">
                    <p>本章首先介绍了 MapReduce 的基础知识和工作流程，然后通过单词统计和二次排序两个案例介绍了如何利用 MapReduce 进行编程。<br>Hadoop 支持多种语言但对 Java 支持最好，在编写 MapReduce 函数时，需要新建 3 个类：Mapper 类、Reducer 类、main 类。另外，前两个类也可以作为内部类放到 main 类中。<br>Mapper 类需要集成 MapRecude API 所提供的Mapper 类并重写 map() 方法，Reduce() 类同理。</p>
<h2 id="一、MapReduce-概述"><a href="#一、MapReduce-概述" class="headerlink" title="一、MapReduce 概述"></a>一、MapReduce 概述</h2><p>MapReduce 是 Hadoop 系统中最重要的计算引擎，它不仅直接支持交互式应用，基于程序的应该，还是 Hive 组件的基础。</p>
<h3 id="1-分布式并行计算"><a href="#1-分布式并行计算" class="headerlink" title="1. 分布式并行计算"></a>1. 分布式并行计算</h3><h4 id="1-分布式计算"><a href="#1-分布式计算" class="headerlink" title="1) 分布式计算"></a>1) 分布式计算</h4><p>一个任务，拆分成无数个小任务，将这些小任务派发给多台计算机进行计算，最后将结构进行汇总以得到最终的结果。</p>
<blockquote>
<p>分解后的任务直接相互独立，计算结果几乎互不影响，对实时性要求不高。</p>
</blockquote>
<h4 id="2-并行计算"><a href="#2-并行计算" class="headerlink" title="2) 并行计算"></a>2) 并行计算</h4><p>允许让多条指令以平行方式同时进行计算的模式，包括<strong>时间与空间并行</strong>两种方式。</p>
<blockquote>
<p>时间并行：多条流水线同时作业<br>空间并行：使用多种计算资源（如多个处理器）执行并发计算。</p>
</blockquote>
<h3 id="2-MapReduce-的含义"><a href="#2-MapReduce-的含义" class="headerlink" title="2. MapReduce 的含义"></a>2. MapReduce 的含义</h3><p>针对大规模集群种的分布式文件即下并行处理的计算模型。</p>
<p>MapReduce 主要将数据处理任务拆分为 M（映射）和 Reduce（规约）两个任务。<br>例如，要统计一个班的数学成绩，数学老师让数学课代表统计它所在班的数学成绩。数学课代表就让每一组的组长统计它们组的数学成绩，相当于 Map 任务，而数学课代表统计处理每个组所报上来的数学成绩，就是 Reduce 任务。由此可以看出，MapReduce 充分体现了 “分而治之”的思想：把一个复杂的任务拆分成小的任务并行处理，从而提高任务的处理速度。</p>
<h3 id="3-MapReduce-的特点"><a href="#3-MapReduce-的特点" class="headerlink" title="3. MapReduce 的特点"></a>3. MapReduce 的特点</h3><p>开发简单易于实现；良好的可扩展性：动态增加节点的方式；高容错性：如果集群中某计算节点出现故障，使得作业执行失败，MapReduce 可自动将作业分配到可用的计算节点上重新执行。</p>
<p>计算局限（不适合数据事务处理或单一请求处理）<br>性能局限<br>应用局限</p>
<h2 id="二、MapReduce-的工作流程"><a href="#二、MapReduce-的工作流程" class="headerlink" title="二、MapReduce 的工作流程"></a>二、MapReduce 的工作流程</h2><p>输入分片和数据格式化，Map过程，Shuffle 过程，Reduce 过程，结果输出</p>
<h3 id="1-输入分片和数据格式化"><a href="#1-输入分片和数据格式化" class="headerlink" title="1. 输入分片和数据格式化"></a>1. 输入分片和数据格式化</h3><p>首先，MapReduce 将存储在 HDFS 中的大规模数据集切分成独立的输入分片，每一个输入分片对应一个 Map 任务。<br>输入分片是一个逻辑概念，因此对输入数据集的切分也是一种<strong>逻辑切分</strong>。</p>
<p>此外，由于 Map 任务的输入要i去是<strong>键值对</strong>的形式，所以需要对输入分片进行格式化，即对输入处理成 <code>&lt;key, balue&gt;</code> 形式的数据，然后再传递给 Map 任务。</p>
<h3 id="2-Map-过程"><a href="#2-Map-过程" class="headerlink" title="2. Map 过程"></a>2. Map 过程</h3><p>利用 Map() 函数来处理数据</p>
<h3 id="3-Shuffle-过程"><a href="#3-Shuffle-过程" class="headerlink" title="3. Shuffle 过程"></a>3. Shuffle 过程</h3><p>通常，Map() 后的输出需要进行一系列处理才交给 Reduce() 任务，这一系列处理过程被称作洗牌（Shuffle）过程。</p>
<blockquote>
<p>这一系列包括有“分区”、“排序”、“合并”、“滥写”、“归并”等。</p>
</blockquote>
<h3 id="4-Reduce-过程"><a href="#4-Reduce-过程" class="headerlink" title="4. Reduce 过程"></a>4. Reduce 过程</h3><p>Reduce() 任务接收归并排序后的数据流，并对已有序的相同 key 的键值对调用一次 Reduce() 函数。<br>另外，Reduce() 任务的输出结果经过输出格式化后再输出到文件系统中，并且输出结果文件名默认为“part-r-00000”开始，逐渐递增。</p>
<h2 id="三、案例解析——单词统计编程"><a href="#三、案例解析——单词统计编程" class="headerlink" title="三、案例解析——单词统计编程"></a>三、案例解析——单词统计编程</h2><h3 id="1-案例描述"><a href="#1-案例描述" class="headerlink" title="1. 案例描述"></a>1. 案例描述</h3><p>假设在 <code>hdfs://hadoop0:9000/jqe/wc/data</code> 中存在两个文本文件（文件中仅有字符串和空格），分别是 <code>words1.txt</code> 和 <code>words2.txt</code>。<br>其中，word1.txt内容如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">this is a good dog</span><br><span class="line">this is a good cat</span><br></pre></td></tr></table></figure>
<p>word2.txt内容如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">this is a bad dog</span><br><span class="line">this is a bad cat</span><br></pre></td></tr></table></figure>

<p>要求 <code>计算这两个文件的单词频数</code>，输出结果 <code>按照单词的字母顺序进行排序</code>，并输出到 <code>两个文件中（以字母 g 分隔开来）</code>。另外，还要对输出数据进行格式化：<code>单词和词频之间以~~~~~隔开</code>。</p>
<h3 id="2-设计思路"><a href="#2-设计思路" class="headerlink" title="2. 设计思路"></a>2. 设计思路</h3><p>根据分析，单词统计程序可分为 7 个模块，分别是输入、输入分片及其格式化、设计 map() 函数、分区、设计 reduce() 函数、输出格式化、输出。</p>
<blockquote>
<ol>
<li>指定输入文件位置；</li>
<li>将两个文件切分成两个输入分片，对输入分片进行格式化，如文件按行分解，从而形成以 key 为偏移量、value 为行内容的键值对；</li>
<li>设计 map() 函数，将键值对的 value 按空格分解成一个个单词，生成 &lt;word, l&gt;形式的键值对。</li>
<li>设计分区函数，将 key 的首字母小于 g 的键值对划分为 1 个分区，其余的划分在另一个分区。</li>
<li>设计 reduce() 函数，将输入的 &lt;word, list(value)&gt; 形式（如 &lt;”ls”,{1, 1}&gt;）的数据进行汇总，生成以 key 为单词、value 为单词频数的键值对。</li>
<li>系统默认的输出格式为“单词+空格+单词频数”的形式，若要输出特定样式的数据，需要对输出结果进行格式化，使得单词与但磁盘技能书之间以“~~~~~”间隔。</li>
<li>指定单词统计程序的输出结果文件位置。</li>
</ol>
</blockquote>
<h3 id="3-编程实现"><a href="#3-编程实现" class="headerlink" title="3. 编程实现"></a>3. 编程实现</h3><h3 id="4-运行程序"><a href="#4-运行程序" class="headerlink" title="4. 运行程序"></a>4. 运行程序</h3><h2 id="四、案例解析——二次排序编程"><a href="#四、案例解析——二次排序编程" class="headerlink" title="四、案例解析——二次排序编程"></a>四、案例解析——二次排序编程</h2>
                </div>
                <!-- 4. 正文更新时间 -->
                <div class="post-footer__meta">
                    <p>更新于  2022-09-11 21:46:04 星期日</p>
                </div>
            </article>



            <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.js"></script>
            <script type="text/javascript">$(".highlight").wrap("<div class='code-wrapper' style='position:relative'></div>");!function (e, t, a) {var initCopyCode = function () {var copyHtml = '';copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';copyHtml += '  <i class="fa fa-clipboard"></i><span>复制</span>';copyHtml += '</button>';$(".highlight .code").before(copyHtml);var clipboard = new ClipboardJS('.btn-copy', {target: function (trigger) {return trigger.nextElementSibling;}});clipboard.on('success', function (e) {e.trigger.innerHTML = "<i class='fa fa-clipboard'></i><span>复制成功</span>";setTimeout(function () {e.trigger.innerHTML = "<i class='fa fa-clipboard'></i><span>复制</span>"}, 1000);e.clearSelection();});clipboard.on('error', function (e) {e.trigger.innerHTML = "<i class='fa fa-clipboard'></i><span>复制失败</span>";setTimeout(function () {e.trigger.innerHTML = "<i class='fa fa-clipboard'></i><span>复制</span>"}, 1000);e.clearSelection();});};initCopyCode();}(window, document);</script>
        </main>
<!-- 我们是__主体部分！我是__尾部部分！ -->
        <footer class="footer">
            <a href="#" class="button" id="b2t" title="回到顶部">
                <svg t="1662256713839" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
                p-id="3050" width="50" height="50">
                    <path d="M512 0C230.4 0 0 230.4 0 512s230.4 512 512 512 512-230.4 512-512S793.6 0 512 0zM697.6 582.4 627.2 582.4c-12.8 0-19.2 6.4-19.2 19.2l0 108.8c0 6.4-6.4 12.8-12.8 12.8L428.8 723.2c-6.4 0-12.8-6.4-12.8-12.8L416 595.2c0-6.4-6.4-19.2-19.2-19.2L326.4 576C320 582.4 320 576 320 576l179.2-172.8c6.4-6.4 12.8-6.4 19.2 0L704 576C704 576 704 582.4 697.6 582.4zM704 364.8 320 364.8c-19.2 0-32-12.8-32-32S300.8 300.8 320 300.8l384 0c19.2 0 32 12.8 32 32S723.2 364.8 704 364.8z"
                        p-id="3051" fill="#bfbfbf"></path>
                </svg>
            </a>
            <p class="footer-copyright">Copyright © 2022&nbsp;-&nbsp;2022 Koi_NL</p>
            <p class="poems_of_today"><span id="jinrishici-sentence">悟已往之不谏，知来者之可追。</span><script src="https://sdk.jinrishici.com/v2/browser/jinrishici.js" charset="utf-8"></script></p>
        </footer>
    </div>
</body>
</html>